# 使用非数值型预测变量的线性回归
我们来聊聊当你将分类变量添加到预测变量的组合中时，线性回归中会发生什么。这是具有两个预测变量的一般回归方程。

**Y = β0 + β1X1 + β2X2**

像我们讨论过的，X 代表每个变量的值。这些直接来自数据，而 β's 来自线性回归模型。β0 为截距。另一个 β's 代表预测变量 X 和目标变量 Y 之间的关系。

## 添加分类预测变量
假设你添加了一个非数值型或分类变量，作为第三个变量。现在将类别的实际值放入方差中将不起作用，因为你不能使用字符串变量来做数学运算，因此我们必须以某种方式转换变量。没有经验的分析师可以会简单地为每个类别分配一个数字并将其插入模型中。

**Y = β0 + β1X1 + β2X2 + β3X3**
我们花点时间探索这个问题。在线性回归中，每个预测变量的系数或斜率代表它与目标变量之间的关系。因此，如果将类别转换为数值型变量，则假定目标变量和类别数字之间存在线性关系。由于类别数字通常是任意分配的，所以没有意义。

## 转换分类变量 —— 错误示例
我们来看一个例子。我们有一个数据集，其中包含美国 50 个州每一个州的一些信息。
<img src="https://github.com/JayFrank/ContinuousLearning/blob/master/Udacity-Business%20Data%20Analysis%20Nanodegree/7.%20%E5%BF%85%E4%BF%AE%E8%AF%BE%E7%A8%8B%20-%20%E7%94%A8%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E8%A7%A3%E5%86%B3%E5%95%86%E4%B8%9A%E9%97%AE%E9%A2%98/Lesson3-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/Link/4-1.png"  height="360">

我们想预测每个州对每名未成年学生的开支。为此，我们将使用三个预测变量：该州的平均收入、18 岁以下人口的百分比，以及该州所属的区域。下面是构建模型后将得到的回归方程。区域是具有四个值的分类变量：西部、中西部、东北部、东南部。你分别为它们分配编号 1、2、3 和 4，并运行模型。结果将给出以下等式：

**Expenditures = -530 + 0.073 Avg_Income + 1406.36 Pct_Under_18 + 6.53 region**

现在我们简单地来了解一下系数：
* 平均收入系数意味着每增加 1 美元的平均收入，该州对每名未成年学生将多 7.3 美分的开支。
* 18 岁以下人口的百分比系数意味着 18 岁以下人口每增加一个百分点，该州对每名未成年学生将多 14 美元的开支。
* 区域系数意味着对于一个区域的每一次增加，该州对每名未成年学生将多 6.52 美元的开支。这个逻辑不太对，数字中没有逻辑顺序，并且此格式无法让我们考虑到区域之间的差异。

## 转换分类变量 —— 正确示例
在回归中使用分类变量的一个更好的方式，是使用所谓的虚拟变量（dummy variables）。虚拟变量只能取两个值，一般是 0 或 1。你可以添加比分类变量中唯一值数量少一个的虚拟变量数。所以，如果变量是二元的，则添加一个虚拟变量。如果有四个类别，则添加三个虚拟变量。

回到我们的例子，现在我们使用虚拟变量来表示分类变量 region（区域）。要表示西部、中西部、东北和东南部四个类别，你需要添加三个虚拟变量。我们为中西部、东南部和西部各创建一个。

**Expenditures = β0 + β1 Avg_Income + β2 Pct_Under_18 + β3 midwest + β4 southeast + β5 west**

每个虚拟变量取值 1 或 0。如果一个州位于东南部，则东南（southeast）变量的值为 1，而其他两个变量为 0。

我们没有为东北创建变量。这是因为方程需要一个没有编码成虚拟变量的基准值。如果一个州位于东北部，则所有三个虚拟变量的值都将为 0。你创建的虚拟变量数要始终比类别数量少一个，以确保一个类别表示为虚拟变量全部为 0。在此例子中这一个类别是东北部，成为其他类的对比类别。

**注意:** 许多软件工具，如 Alteryx，会自动将分类变量转换为虚拟变量。如果你要手动执行，可以通过 Excel 配套 **if** 或其它函数来模拟，也很方便。数据现在看起来会是下面这样的：
<img src="https://github.com/JayFrank/ContinuousLearning/blob/master/Udacity-Business%20Data%20Analysis%20Nanodegree/7.%20%E5%BF%85%E4%BF%AE%E8%AF%BE%E7%A8%8B%20-%20%E7%94%A8%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E8%A7%A3%E5%86%B3%E5%95%86%E4%B8%9A%E9%97%AE%E9%A2%98/Lesson3-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/Link/4-2.png"  height="360">

**问题1：** 在将分类变量转换成虚拟变量之后，我们该如何执行线性回归呢？是否应当确认这些虚拟变量与被预测变量的相关性呢？（答案:是）

**问题2：** 如果分类变量 Industry（行业）用于回归，且它有三个唯一的值：制造业、服务业和零售业，你应该在回归中使用多少个虚拟变量？（答案:2）
